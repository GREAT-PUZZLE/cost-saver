<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Great Puzzle - ESG Cost Simulator (2026 Enterprise Edition)</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script type="text/javascript">
        (function() {
            // ëŒ€í‘œë‹˜ ê³„ì • Public Key ì´ˆê¸°í™”
            emailjs.init("rMKdHnzyb418h9t0V");
        })();
    </script>
    
    <script>
        // â–¼â–¼â–¼ [ì„¤ì •] 2026ë…„ ê·¸ë ˆì´íŠ¸í¼ì¦ ê°€ê²© ì •ì±… (ìœ„ê³„ êµ¬ì¡° í™•ë¦½) â–¼â–¼â–¼
        // ëª©í‘œ: ë¶€ë‹´ê¸ˆ(431ë§Œ) > ë Œíƒˆ > í•˜ì´ë¸Œë¦¬ë“œ > êµ¬ë§¤(208ë§Œ)
        const BASE_CONFIG = {
            // ì¸ê±´ë¹„: 2026ë…„ ìµœì €ì‹œê¸‰ 10,320ì› + 4ëŒ€ë³´í—˜ (ê³ ì •ë¹„)
            labor: 1050000, 
            
            // [êµ¬ë§¤í˜•] Best Option (ê°€ì¥ ì €ë ´, 208ë§Œì› ëª©í‘œ)
            // ê¸°ê¸°ê°’ 3650ë§Œ + ìš´ì˜ë¹„ 98ë§Œ
            purchaseListPrice: 36500000, 
            purchaseOp: 980000,       
            
            // [ë Œíƒˆí˜•] High Option (ì´ˆê¸°ë¹„ìš© 0ì›, ê°€ì¥ ë¹„ìŒˆ)
            // ê¸°ì¡´ 195ë§Œ -> 260ë§Œì›ìœ¼ë¡œ ìƒí–¥ ì¡°ì •í•˜ì—¬ í•˜ì´ë¸Œë¦¬ë“œì™€ ê²©ì°¨ ë²Œë¦¼
            // ì„¸ì „ ì•½ 300~310ë§Œì› -> ì„¸í›„ 240~250ë§Œì›ëŒ€ í˜•ì„± ìœ ë„
            rentalMonthly: 3400000,  
            
            // [í•˜ì´ë¸Œë¦¬ë“œ] Middle Option (ì¤‘ê°„ ê°€ê²©)
            // ë³´ì¦ê¸ˆ 1500ë§Œ / ë Œíƒˆë£Œ 90ë§Œ / ìš´ì˜ë¹„(purchaseOp) ë³„ë„
            // ì„¸í›„ 220~230ë§Œì›ëŒ€ í˜•ì„± ìœ ë„
            hybridDeposit: 15000000, 
            hybridRent: 900000,

            // [ì„¸ê¸ˆ] ë²•ì¸ì„¸(19%) + ì§€ë°©ì†Œë“ì„¸(1.9%) = ì‹¤ì§ˆ ì ˆê°ìœ¨ 20.9%
            taxRate: 0.209 
        };

        // 2026ë…„ ë¶€ë‹´ê¸ˆ êµ¬ê°„ (ìµœì €ì„ê¸ˆ 10,320ì› ë°˜ì˜ ì¶”ì •ì¹˜)
        const BURDEN_TIERS = [
            { limit: 0, cost: 2156880, label: "0% (ì‹¬ê°)" },      // ìµœì €ì„ê¸ˆ ì›” í™˜ì‚°ì•¡
            { limit: 0.25, cost: 1812190, label: "25% ë¯¸ë§Œ" },    // ì•½ 2.9% ì¸ìƒ ì ìš©
            { limit: 0.50, cost: 1553280, label: "50% ë¯¸ë§Œ" },
            { limit: 0.75, cost: 1372100, label: "75% ë¯¸ë§Œ" },
            { limit: 1.0, cost: 1294400, label: "75% ì´ìƒ" }      // ë¶€ë‹´ê¸°ì´ˆì•¡ í•˜í•œì„ 
        ];
    </script>

    <style>
        /* â–¼â–¼â–¼ ìŠ¤íƒ€ì¼ ì •ì˜ (Full Design - ê¸°ì¡´ ìŠ¤íƒ€ì¼ 100% ìœ ì§€) â–¼â–¼â–¼ */
        :root { 
            --primary: #2563eb; 
            --primary-dark: #1e40af;
            --bg: #f8fafc; 
            --text: #334155; 
            --border: #e2e8f0; 
            --accent: #10b981; 
            --danger: #ef4444; 
            --dark: #1e293b;
            --card-bg: #ffffff;
            --disabled: #94a3b8;
        }

        body { 
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; 
            background: var(--bg); 
            color: var(--text); 
            margin: 0; 
            padding: 40px 20px; 
            line-height: 1.6; 
        }
        
        .container { 
            max-width: 1280px; 
            margin: 0 auto; 
            background: var(--card-bg); 
            border-radius: 24px; 
            box-shadow: 0 20px 40px rgba(0,0,0,0.08); 
            padding: 50px; 
            position: relative; 
            overflow: hidden;
        }
        
        /* í—¤ë” ìŠ¤íƒ€ì¼ */
        header { 
            text-align: center; 
            margin-bottom: 50px; 
            position: relative;
        }
        
        header h1 { 
            margin: 0; 
            font-size: 2.4rem; 
            color: var(--dark); 
            font-weight: 900; 
            letter-spacing: -1px; 
        }
        
        header p { 
            font-size: 1.1rem; 
            color: #64748b; 
            margin-top: 10px; 
        }

        /* ì¸ì¦ ë°°ì§€ ìŠ¤íƒ€ì¼ */
        .badge-container { 
            display: flex; 
            flex-wrap: wrap; 
            justify-content: center; 
            gap: 12px; 
            margin-top: 25px; 
        }

        .cert-badge { 
            background: white; 
            color: #64748b; 
            padding: 10px 18px; 
            border-radius: 50px; 
            cursor: pointer; 
            font-size: 0.95rem; 
            font-weight: 700; 
            border: 1px solid #cbd5e1; 
            display: flex; 
            align-items: center; 
            gap: 8px; 
            transition: all 0.2s ease; 
        }

        .cert-badge:hover { 
            transform: translateY(-3px); 
            border-color: var(--primary); 
            color: var(--primary); 
            box-shadow: 0 5px 15px rgba(37,99,235,0.15); 
        }

        .cert-badge.active { 
            background: #eff6ff; 
            color: var(--primary); 
            border-color: var(--primary); 
            box-shadow: 0 0 0 2px rgba(37,99,235,0.2); 
        }

        .badge-icon { 
            width: 10px; 
            height: 10px; 
            border-radius: 50%; 
            background: currentColor; 
        }

        /* ì¸ì¦ì„œ í‘œì‹œ ì˜ì—­ */
        #cert-display-area { 
            max-height: 0; 
            overflow: hidden; 
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1); 
            opacity: 0; 
            margin-bottom: 20px; 
        }

        #cert-display-area.show { 
            max-height: 800px; 
            opacity: 1; 
            margin-bottom: 50px; 
        }

        .cert-visual { 
            background: #fff; 
            border: 1px solid var(--border); 
            padding: 40px; 
            max-width: 700px; 
            margin: 0 auto; 
            text-align: center; 
            border-radius: 16px; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.05); 
        }

        .cert-title { 
            font-size: 1.8rem; 
            font-weight: 800; 
            margin-bottom: 20px; 
            color: var(--dark); 
            border-bottom: 3px solid var(--dark); 
            display: inline-block; 
            padding-bottom: 8px; 
        }

        .cert-content { 
            font-size: 1.1rem; 
            line-height: 1.8; 
            color: #475569; 
            text-align: left; 
            background: #f8fafc; 
            padding: 20px; 
            border-radius: 8px; 
        }

        /* ì…ë ¥ ì„¹ì…˜ ìŠ¤íƒ€ì¼ */
        .input-section { 
            background: #f0f9ff; 
            padding: 40px; 
            border-radius: 20px; 
            margin-bottom: 40px; 
            display: grid; 
            grid-template-columns: 1fr 1fr; 
            gap: 40px; 
            border: 1px solid #bae6fd; 
        }
        
        .sector-selector { 
            grid-column: 1 / -1; 
            margin-bottom: 10px; 
        }

        .sector-label {
            font-weight: 800;
            color: #1e40af;
            margin-bottom: 15px;
            display: block;
            font-size: 1.2rem;
        }

        .sector-tabs { 
            display: flex; 
            gap: 10px; 
            background: white; 
            padding: 5px; 
            border-radius: 12px; 
            border: 1px solid #e2e8f0; 
            width: fit-content; 
        }

        .sector-btn { 
            padding: 12px 24px; 
            border: none; 
            background: transparent; 
            color: #64748b; 
            border-radius: 8px; 
            cursor: pointer; 
            font-weight: 700; 
            font-size: 1rem; 
            transition: 0.2s; 
        }

        .sector-btn.active { 
            background: var(--primary); 
            color: white; 
            box-shadow: 0 4px 10px rgba(37,99,235,0.3); 
        }

        .input-group label { 
            font-weight: 800; 
            display: block; 
            margin-bottom: 15px; 
            color: #1e40af; 
            font-size: 1.2rem; 
        }

        .input-row { 
            display: flex; 
            gap: 20px; 
            align-items: center; 
        }

        .input-row input[type=range] { 
            flex-grow: 1; 
            cursor: pointer; 
            height: 10px; 
            accent-color: var(--primary); 
        }

        .input-row input[type=number] { 
            width: 140px; 
            padding: 15px; 
            border: 2px solid #93c5fd; 
            border-radius: 10px; 
            text-align: right; 
            font-weight: 800; 
            font-size: 1.4rem; 
            color: #1e3a8a; 
            outline: none;
        }

        .input-row input[type=number]:focus { 
            border-color: var(--primary); 
            box-shadow: 0 0 0 3px rgba(37,99,235,0.2); 
        }

        /* ë©”ì¸ ë²„íŠ¼ */
        .btn-main { 
            width: 100%; 
            padding: 24px; 
            background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%); 
            color: white; 
            border: none; 
            border-radius: 16px; 
            font-size: 1.5rem; 
            font-weight: 800; 
            cursor: pointer; 
            transition: transform 0.2s, box-shadow 0.2s; 
            box-shadow: 0 15px 30px rgba(37,99,235,0.3); 
            margin-bottom: 20px;
        }

        .btn-main:hover { 
            transform: translateY(-3px); 
            box-shadow: 0 20px 40px rgba(37,99,235,0.4); 
        }

        /* ê²°ê³¼ ë ˆì´ì•„ì›ƒ */
        .result-layout { 
            display: none; 
            grid-template-columns: 400px 1fr; 
            gap: 30px; 
            margin-top: 50px; 
            animation: slideUpFade 0.6s ease-out;
            align-items: start; 
        }

        @keyframes slideUpFade { 
            from { opacity:0; transform:translateY(30px); } 
            to { opacity:1; transform:translateY(0); } 
        }

        /* ì™¼ìª½ ì •ë³´ íŒ¨ë„ */
        .info-card { 
            border: 1px solid var(--border); 
            border-radius: 20px; 
            padding: 30px; 
            background: white; 
            box-shadow: 0 10px 20px rgba(0,0,0,0.03); 
            margin-bottom: 27px;
            width: 100%; 
            box-sizing: border-box;
        }

        .card-title { 
            font-weight: 800; 
            color: #475569; 
            margin-bottom: 27px; 
            display: flex; 
            align-items: center; 
            gap: 8px;
            font-size: 1.1rem; 
            border-bottom: 2px solid #f1f5f9; 
            padding-bottom: 17px; 
        }

        .stat-row { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            margin-bottom: 18px; 
            font-size: 1.05rem; 
            color: #475569; 
        }

        .stat-val { 
            font-weight: 800; 
            color: var(--dark); 
            font-size: 1.2rem; 
        }

        .highlight-red { color: var(--danger); font-size: 1.5rem; }
        .highlight-blue { color: var(--primary); font-weight: 900; }

        /* í• ì¸ í…Œì´ë¸” */
        .discount-table { 
            width: 100%; 
            border-collapse: separate; 
            border-spacing: 0; 
            font-size: 0.95rem; 
            text-align: center; 
            border: 1px solid #e2e8f0; 
            border-radius: 12px; 
            overflow: hidden; 
        }

        .discount-table th { 
            background: #f8fafc; 
            padding: 12px; 
            border-bottom: 1px solid #e2e8f0; 
            color: #64748b; 
            font-weight: 700; 
        }

        .discount-table td { 
            padding: 12px; 
            border-bottom: 1px solid #f1f5f9; 
            color: #334155; 
        }

        .discount-table tr:last-child td { border-bottom: none; }
        
        .active-tier { background: #eff6ff; font-weight: 800; color: var(--primary); }
        .active-tier td { background: #eff6ff; border-top: 2px solid var(--primary); border-bottom: 2px solid var(--primary); }

        /* ì˜¤ë¥¸ìª½ ê²°ê³¼ íŒ¨ë„ */
        .right-panel { 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
        }

        .mode-tabs { display: flex; gap: 12px; margin-bottom: 30px; width: 100%; max-width: 900px; justify-content: center; }
        
        .tab-btn { 
            padding: 14px 28px; 
            border: 1px solid #cbd5e1; 
            background: white; 
            border-radius: 12px; 
            cursor: pointer; 
            font-weight: 700; 
            color: #64748b; 
            transition: 0.2s; 
            flex: 1; 
            font-size: 1rem;
        }

        .tab-btn.active { 
            background: var(--dark); 
            color: white; 
            border-color: var(--dark); 
            box-shadow: 0 5px 15px rgba(30,41,59,0.3); 
        }

        .rp-card { 
            background: white; border: 1px solid #e2e8f0; padding: 20px; border-radius: 16px; margin-bottom: 20px; width: 100%; max-width: 900px; box-sizing: border-box; 
        }

        .target-grid { 
            display: grid; 
            grid-template-columns: repeat(4, 1fr); 
            gap: 12px; 
            margin-bottom: 30px; 
            background: #f8fafc; 
            padding: 10px; 
            border-radius: 16px; 
            border: 1px solid #e2e8f0; 
        }

        .target-btn { 
            padding: 12px; 
            border: 1px solid #e2e8f0; 
            background: white; 
            border-radius: 10px; 
            cursor: pointer; 
            transition: 0.2s; 
            font-weight: 700; 
            color: #64748b; 
            font-size: 0.9rem;
        }

        .target-btn:hover { border-color: var(--primary); color: var(--primary); }
        
        .target-btn.selected { 
            background: var(--primary); 
            color: white; 
            border-color: var(--primary); 
            box-shadow: 0 4px 12px rgba(37,99,235,0.25); 
        }

        .target-btn.disabled {
            background: #e2e8f0;
            color: #94a3b8;
            border-color: #cbd5e1;
            cursor: not-allowed;
            pointer-events: auto; 
        }

        .result-box { 
            border: 2px solid #bae6fd; 
            background: #f0f9ff; 
            border-radius: 20px; 
            padding: 30px; 
            position: relative; 
            margin-bottom: 20px;
            width: 100%;
            max-width: 900px;
            box-sizing: border-box;
        }

        .result-grid { 
            display: grid; 
            grid-template-columns: 1fr 1fr; 
            gap: 20px; 
            row-gap: 30px; 
            margin-bottom: 30px; 
        }

        .res-item { display: flex; flex-direction: column; }
        
        .res-label { 
            font-size: 0.95rem; 
            color: #1e40af; 
            font-weight: 700; 
            margin-bottom: 8px; 
            text-transform: uppercase; 
            letter-spacing: 0.5px; 
        }

        .res-value { 
            font-size: 1.8rem; 
            font-weight: 900; 
            color: #1e3a8a; 
            letter-spacing: -0.5px; 
        }

        .res-sub { 
            font-size: 0.9rem; 
            color: #3b82f6; 
            margin-top: 5px; 
            font-weight: 500; 
        }

        /* â–¼â–¼â–¼ [ë¹„ìš© ìƒì„¸ ë¶„í•  ìŠ¤íƒ€ì¼] â–¼â–¼â–¼ */
        .cost-breakdown {
            margin-top: 8px;
            font-size: 0.85rem;
            color: #64748b;
            background: rgba(255,255,255,0.6);
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #dbeafe;
        }
        .cost-breakdown .cb-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 4px;
        }
        .cost-breakdown .cb-val {
            font-weight: 700;
            color: #1e3a8a;
        }

        .savings-highlight { 
            background: var(--dark); 
            color: white; 
            border-radius: 16px; 
            padding: 25px; 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            box-shadow: 0 15px 30px rgba(30, 41, 59, 0.25); 
            margin-top: 10px; 
        }

        .savings-title { font-size: 1.2rem; font-weight: 700; color: #94a3b8; }
        .savings-amount { font-size: 2rem; font-weight: 900; color: #4ade80; }
        
        .savings-rate-badge { 
            background: #4ade80; 
            color: #064e3b; 
            padding: 5px 12px; 
            border-radius: 6px; 
            font-size: 1rem; 
            font-weight: 800; 
            margin-left: 12px; 
            vertical-align: middle; 
        }

        /* â–¼â–¼â–¼ ì°¨íŠ¸ ì „ìš© ì˜ì—­ (Full Width) â–¼â–¼â–¼ */
        .chart-area { 
            width: 100%; 
            max-width: 900px;
            height: 565px; 
            margin-top: 0; 
            background: white; 
            padding: 30px; 
            border-radius: 20px; 
            border: 1px solid #e2e8f0; 
            box-shadow: 0 10px 20px rgba(0,0,0,0.02);
            box-sizing: border-box;
            margin-bottom: 60px;
        }

        /* â–¼â–¼â–¼ ì—°ë½ì²˜ í¼ (Full Width) â–¼â–¼â–¼ */
        .contact-section {
            padding: 32px 28px;
            text-align: center;
            background: #ffffff;
            border: 1px solid #e2e8f0;
            border-radius: 20px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.03);
            width: 100%;
            max-width: 900px;
            box-sizing: border-box; 
        }

        .contact-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
            width: 100%;
            max-width: 640px;      
            margin: 0 auto;        
        }

        .contact-form input[type="text"] { 
            padding: 18px; border: 1px solid #cbd5e1; border-radius: 12px; font-size: 1.1rem; 
            width: 100%; box-sizing: border-box; transition: border-color 0.2s; 
        }
        .contact-form input[type="text"]:focus { border-color: var(--primary); outline: none; box-shadow: 0 0 0 3px rgba(37,99,235,0.1); }
        
        .agree-box { background: #f8fafc; padding: 18px; border-radius: 12px; border: 1px solid #e2e8f0; display: flex; align-items: center; justify-content: center; gap: 12px; cursor: pointer; }
        .agree-box input[type="checkbox"] { width: 20px !important; height: 20px !important; margin: 0; accent-color: #1e293b; cursor: pointer; }
        .agree-box label { font-size: 1rem; color: #64748b; cursor: pointer; font-weight: 500; white-space: nowrap; position: relative; top: -1px; }

        /* ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.8); backdrop-filter: blur(5px); z-index: 9999; display: none; justify-content: center; align-items: center; }
        .modal-content { background: white; width: 90%; max-width: 1100px; border-radius: 24px; padding: 50px; box-shadow: 0 25px 50px rgba(0, 0, 0, 0.3); animation: popUp 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); text-align: center; position: relative; max-height: 90vh; overflow-y: auto; }
        @keyframes popUp { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        .modal-header h2 { font-size: 2.2rem; margin: 0 0 15px; color: #1e293b; font-weight: 900; }
        .solution-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 30px; margin: 40px 0; }
        .sol-card { background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 20px; padding: 30px; text-align: center; transition: 0.3s; display: flex; flex-direction: column; }
        .sol-card:hover { transform: translateY(-10px); border-color: var(--primary); box-shadow: 0 20px 40px rgba(37,99,235,0.1); }
        .sol-icon { font-size: 4rem; margin-bottom: 20px; display: block; }
        .sol-title { font-weight: 800; font-size: 1.4rem; margin-bottom: 20px; display: block; color: var(--dark); }
        .sol-list { list-style: none; padding: 0; margin: 0; text-align: left; font-size: 1rem; color: #475569; line-height: 1.8; }
        .sol-list li { margin-bottom: 12px; padding-left: 28px; position: relative; }
        .sol-list li::before { content: "âœ”"; color: var(--accent); position: absolute; left: 0; font-weight: 900; font-size: 1.2rem; }
        .modal-btn { width: 100%; padding: 22px; background: var(--primary); color: white; border: none; border-radius: 16px; font-size: 1.4rem; font-weight: 800; cursor: pointer; transition: 0.2s; box-shadow: 0 10px 20px rgba(37,99,235,0.3); }
        .modal-btn:hover { background: var(--primary-dark); transform: scale(1.02); }

        #overflowPopup .modal-content { max-width: 600px; padding: 40px; border: 2px solid #ef4444; }
        #overflowPopup h2 { color: #ef4444; }
        .warning-box { background: #fef2f2; padding: 20px; border-radius: 12px; margin: 20px 0; color: #b91c1c; text-align: left; font-size: 1.05rem; line-height: 1.6; }

        /* ============================
           âœ… 1ì¸ë‹¹ ë¹„êµ ì¹´ë“œ íƒ€ì´í¬ ê°œì„  (2ì¸ ê¸°ì¤€ìœ¼ë¡œ êµì²´)
           ============================ */
        .compare-wrap{
            display: flex;
            flex-direction: column;
            gap: 14px;
        }

        .compare-title{
            text-align:center;
            margin: 0 0 14px;
            color:#1e293b;
            font-size:1.12rem;
            letter-spacing:-0.2px;
            font-weight: 900;
        }

        .compare-card{
            background:#fff;
            border-radius:14px;
            padding:16px 16px 14px;
            border: 1px solid #e2e8f0;
            box-shadow: 0 6px 14px rgba(0,0,0,0.03);
        }

        .compare-card.danger{
            border-color:#fecaca;
            background: linear-gradient(180deg, rgba(254,242,242,0.9) 0%, #ffffff 70%);
        }
        .compare-card.primary{
            border-color:#bfdbfe;
            background: linear-gradient(180deg, rgba(239,246,255,0.95) 0%, #ffffff 70%);
        }

        .compare-head{
            display:flex;
            align-items:center;
            justify-content: space-between;
            gap: 10px;
            margin-bottom: 8px;
        }

        .compare-label{
            font-size:0.92rem;
            font-weight: 900;
            letter-spacing: -0.2px;
        }

        .compare-label.danger{ color:#991b1b; }
        .compare-label.primary{ color:#1e40af; }

        .compare-badge{
            font-size:0.78rem;
            font-weight: 800;
            color:#64748b;
            background:#f1f5f9;
            border:1px solid #e2e8f0;
            padding:6px 10px;
            border-radius:999px;
            white-space: nowrap;
        }

        .compare-amount{
            display:flex;
            align-items: baseline;
            gap: 6px;
        }

        .compare-amount .num{
            font-size:1.7rem;
            font-weight: 950;
            letter-spacing: -0.6px;
            line-height: 1.2;
        }

        .compare-amount .unit{
            font-size:0.95rem;
            font-weight: 800;
            color:#64748b;
        }

        .compare-amount.danger .num{ color:#ef4444; }
        .compare-amount.primary .num{ color:#2563eb; }

        .compare-sub{
            margin-top: 8px;
            font-size:0.84rem;
            color:#64748b;
            line-height: 1.45;
        }

        .compare-vs{
            text-align:center;
            font-weight: 900;
            color:#94a3b8;
            font-size: 0.95rem;
            letter-spacing: 0.6px;
            margin: -4px 0;
        }

        .compare-save-pill{
            display:inline-flex;
            align-items:center;
            justify-content:center;
            gap: 8px;
            padding:8px 14px;
            border-radius:999px;
            font-weight: 900;
            font-size: 0.92rem;
            border:1px solid #bbf7d0;
            background:#d1fae5;
            color:#065f46;
            box-shadow: 0 8px 18px rgba(16,185,129,0.12);
        }

        @media (max-width: 900px) {
            .container { padding: 20px; width: 95%; margin: 20px auto; }
            .input-section { grid-template-columns: 1fr; padding: 25px; }
            .result-layout { grid-template-columns: 1fr; }
            .solution-grid { grid-template-columns: 1fr; }
            .target-grid { grid-template-columns: repeat(2, 1fr); }
            header h1 { font-size: 1.8rem; }

            .right-panel .mode-tabs,
            .right-panel .rp-card,
            .right-panel .result-box,
            .right-panel .chart-area,
            .right-panel .contact-section{
                max-width: 100%;
            }
            .right-panel .contact-section{
                max-width: 100%;
            }
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>GreatPuzzle : ESG ê¸°ë°˜ ë¹„ìš© ì ˆê° ì‹œë®¬ë ˆì´í„°</h1>
        <p>ì¤‘ì¦ ì¥ì• ì¸ ê³ ìš© ê¸°ë°˜ ESG ì†”ë£¨ì…˜<br><b>ê³ ìš©ë¶€ë‹´ê¸ˆ ìµœëŒ€ 56.1% ì ˆê°</b>, íƒ„ì†Œ ì ˆê°ê³¼ ìì›ìˆœí™˜ ì„±ê³¼ê¹Œì§€ í•œ ë²ˆì—.</p>
        
        <div class="badge-container">
            <div class="cert-badge" onclick="showCert('innoprod', this)"><div class="badge-icon"></div>ì¡°ë‹¬ì²­ í˜ì‹ ì œí’ˆ ì§€ì •</div>
            <div class="cert-badge" onclick="showCert('pilot', this)"><div class="badge-icon"></div>ì¤‘ê¸°ë¶€ ì‹œë²”êµ¬ë§¤ ì„ ì •</div>
            <div class="cert-badge" onclick="showCert('venture', this)"><div class="badge-icon"></div>ë²¤ì²˜ê¸°ì—… ì¸ì¦</div>
            <div class="cert-badge" onclick="showCert('social', this)"><div class="badge-icon"></div>ì†Œì…œë²¤ì²˜ íŒë³„</div>
        </div>
    </header>

    <div id="cert-display-area">
        <div class="cert-visual">
            <div class="cert-title" id="cert-title-text">ì¸ì¦ì„œ ì œëª©</div>
            <div class="cert-content" id="cert-content-text">ë‚´ìš©</div>
        </div>
    </div>

    <div class="input-section">
        <div class="sector-selector">
            <label class="sector-label">ğŸ¢ ê¸°ì—…/ê¸°ê´€ í˜•íƒœ (ì˜ë¬´ ê³ ìš©ë¥ )</label>
            <div class="sector-tabs">
                <button class="sector-btn active" onclick="setSector('private', this)">ë¯¼ê°„ê¸°ì—… (3.1%)</button>
                <button class="sector-btn" onclick="setSector('public', this)">ê³µê³µê¸°ê´€ (3.8%)</button>
            </div>
        </div>

        <div class="input-group">
            <label>ğŸ‘¥ ì „ì²´ ìƒì‹œ ê·¼ë¡œì ìˆ˜</label>
            <div class="input-row">
                <input type="range" id="range-total" min="50" max="100000" step="50" value="1000" oninput="syncVal('total', this.value)">
                <input type="number" id="input-total" value="1000" oninput="syncVal('total', this.value)">
            </div>
        </div>
        <div class="input-group">
            <label>â™¿ í˜„ì¬ ì¥ì• ì¸ ê·¼ë¡œì ìˆ˜ (ì¸ì • ì¸ì›)</label>
            <div class="input-row">
                <input type="range" id="range-dis" min="0" max="2000" step="1" value="0" oninput="syncVal('dis', this.value)">
                <input type="number" id="input-dis" value="0" oninput="syncVal('dis', this.value)">
            </div>
        </div>
    </div>

    <button class="btn-main" onclick="openPopup()">ğŸ“Š ë¶„ì„ ê²°ê³¼ í™•ì¸í•˜ê¸°</button>

    <div id="resultArea" class="result-layout">
        <div class="left-panel">
            <div class="info-card">
                <span class="card-title">ğŸ“Š í˜„ì¬ ë¹„ìš© ë¶„ì„ (ë„ì… ì „)</span>
                <div class="stat-row">
                    <span>ì˜ë¬´ ê³ ìš© ì¸ì›</span>
                    <span class="stat-val"><span id="val-mandatory">0</span>ëª…</span>
                </div>
                <div class="stat-row">
                    <span>í˜„ì¬ ê³ ìš©ë¥ </span>
                    <span class="stat-val highlight-blue"><span id="val-current-rate">0.00</span>%</span>
                </div>
                <div class="stat-row">
                    <span>í˜„ì¬ ì¸ì • ì¸ì›</span>
                    <span class="stat-val"><span id="val-current">0</span>ëª…</span>
                </div>
                <div class="stat-row">
                    <span>ë¯¸ë‹¬ ì¸ì› (íŒ¨ë„í‹°)</span>
                    <span class="stat-val text-danger"><span id="val-unfilled">0</span>ëª…</span>
                </div>
                <div class="stat-row">
                    <span>ì ìš© ë¶€ë‹´ê¸ˆ ë‹¨ê°€</span>
                    <span class="stat-val"><span id="val-unit">0</span>ë§Œì›</span>
                </div>
                <div style="border-top:1px dashed #cbd5e1; margin:15px 0;"></div>
                <div class="stat-row">
                    <span>5ë…„ ëˆ„ì  ë¶€ë‹´ê¸ˆ</span>
                    <span class="stat-val highlight-red" id="val-5yLevy">0ì›</span>
                </div>
            </div>

            <div class="info-card" style="margin-top:15px;">
                <span class="card-title">ğŸ’¡ ëŒ€ëŸ‰ ë„ì… í• ì¸í‘œ (ì „ í’ˆëª© ì ìš©)</span>
                <table class="discount-table">
                    <thead><tr><th>ëŒ€ìˆ˜</th><th>í• ì¸ìœ¨</th><th>ë¹„ê³ </th></tr></thead>
                    <tbody>
                        <tr id="row-t1"><td>1~10</td><td>0%</td><td>ì •ê°€</td></tr>
                        <tr id="row-t2"><td>11~20</td><td>15%</td><td>í• ì¸</td></tr>
                        <tr id="row-t3"><td>21~30</td><td>20%</td><td>í• ì¸</td></tr>
                        <tr id="row-t4"><td>31~</td><td>25%</td><td>ìµœëŒ€</td></tr>
                    </tbody>
                </table>
                <div style="text-align:center; margin-top:10px; font-size:0.85rem; color:#64748b;">
                    * 1,000ëŒ€ ì´ìƒì€ <b>íŠ¹ë³„ í”„ë¡œëª¨ì…˜</b>ì´ ìë™ ì ìš©ë©ë‹ˆë‹¤.
                </div>
            </div>

            <div class="info-card" style="margin-top:15px; background:#f8fafc; border:2px dashed #cbd5e1;">
                <h3 class="compare-title">âš–ï¸ 2ì¸ ì˜ë¬´ í•´ê²° ê¸°ì¤€ ì›” ë¹„ìš©</h3>

                <div class="compare-wrap">
                    <div class="compare-card danger">
                        <div class="compare-head">
                            <div class="compare-label danger">ğŸ”´ ë¯¸ê³ ìš© ì‹œ (ë¶€ë‹´ê¸ˆ)</div>
                            <div class="compare-badge">ì†Œë©¸ì„± ë¹„ìš©</div>
                        </div>

                        <div class="compare-amount danger">
                            <span class="num" id="comp-burden-2p">431.4ë§Œì›</span>
                            <span class="unit">/ ì›”</span>
                        </div>

                        <div class="compare-sub">
                            * ì†ê¸ˆë¶ˆì‚°ì… (ë²•ì¸ì„¸ ì ˆê° íš¨ê³¼ ì—†ìŒ)
                        </div>
                    </div>

                    <div class="compare-vs">VS</div>

                    <div class="compare-card primary">
                        <div class="compare-head">
                            <div class="compare-label primary" id="comp-model-label">ğŸ”µ ê·¸ë ˆì´íŠ¸í¼ì¦ (êµ¬ë§¤í˜•)</div>
                            <div class="compare-badge">ESG/ì ˆì„¸</div>
                        </div>

                        <div class="compare-amount primary">
                            <span class="num" id="comp-purchase-2p">208.6ë§Œì›</span>
                            <span class="unit">/ ì›”</span>
                        </div>

                        <div class="cost-breakdown" style="margin-top:10px;">
                            <div class="cb-row" style="color:#1e3a8a;">
                                <span>+ ì¸ê±´ë¹„(3.5H ê·¼ë¬´,4ëŒ€ë³´í—˜):</span>
                                <span style="font-weight:700;">105.0ë§Œì›</span>
                            </div>
                            <div class="cb-row" style="color:#64748b;">
                                <span>+ ì†”ë£¨ì…˜ë¹„(ê¸°ê¸°/ìš´ì˜(ìœ„íƒ ê´€ë¦¬ ë“±)):</span>
                                <span style="font-weight:700;" id="comp-sol-detail">158.8ë§Œì›</span>
                            </div>
                            <div class="cb-row" style="color:#2563eb; border-top:1px dashed #cbd5e1; padding-top:4px; margin-top:4px;">
                                <span>- ì„¸ê¸ˆì ˆê°(20.9%):</span>
                                <span style="font-weight:700;" id="comp-tax-detail">-55.1ë§Œì›</span>
                            </div>
                        </div>

                        <div style="text-align:center; margin-top:6px;">
                            <span class="compare-save-pill" id="comp-save-2p">âš¡ ì›” 222ë§Œì› ì ˆê° (52%)</span>
                        </div>
                    </div>
                </div>
            </div>
<!-- 
            <div class="info-card" style="margin-top:15px; padding:0; overflow:hidden; border:none; box-shadow:none; background:transparent;">
                <div style="position: relative; padding-bottom: 177.78%; height: 0; overflow: hidden; border-radius: 20px; box-shadow: 0 10px 20px rgba(0,0,0,0.1); background:#000;">
                    <iframe style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" 
                        src="https://www.youtube.com/embed/3lv3Srn5rZE?rel=0" 
                        title="Great Puzzle Shorts" 
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                        allowfullscreen>
                    </iframe>
                </div>
                <div style="text-align:center; margin-top:10px; font-weight:700; color:#64748b; font-size:0.95rem;">
                    ğŸ‘† í´ë¦­í•˜ì—¬ ì†”ë£¨ì…˜ êµ¬ë™ ì˜ìƒ í™•ì¸ (Shorts)
                </div>
            </div> -->



        </div>

        <div class="right-panel">
            <div class="mode-tabs">
                <button class="tab-btn active" onclick="setMode('purchase', this)">êµ¬ë§¤í˜• (Best)</button>
                <button class="tab-btn" onclick="setMode('hybrid', this)">í•˜ì´ë¸Œë¦¬ë“œ</button>
                <button class="tab-btn" onclick="setMode('rental', this)">ë Œíƒˆí˜•</button>
            </div>

            <div class="rp-card" style="background:white; border:1px solid #e2e8f0; padding:20px; border-radius:16px; margin-bottom:20px;">
                <span class="card-title" style="border:none; margin-bottom:15px;">ğŸ¯ ëª©í‘œ ë‹¬ì„±ë¥  ì„ íƒ</span>
                <div class="target-grid">
                    <button class="target-btn" id="btn-25" onclick="setTarget(0.25, this)">25% ì¶©ì¡±</button>
                    <button class="target-btn" id="btn-50" onclick="setTarget(0.50, this)">50% ì¶©ì¡±</button>
                    <button class="target-btn" id="btn-75" onclick="setTarget(0.75, this)">75% ì¶©ì¡±</button>
                    <button class="target-btn selected" id="btn-100" onclick="setTarget(1.0, this)">100% (ì™„ì „í•´ê²°)</button>
                </div>
            </div>

            <div class="result-box">
                <div class="result-grid">
                    <div class="res-item">
                        <span class="res-label">í•„ìš” ë¡œë´‡ ëŒ€ìˆ˜ (ì¤‘ì¦ê³ ìš©)</span>
                        <div class="res-value" id="sol-hires">0 ëŒ€</div>
                        <span class="res-sub" id="sol-logic-text">1ëŒ€ë‹¹ ì¥ì• ì¸ 1ëª… (2ë°°ìˆ˜ ì¸ì •)</span>
                    </div>
                    <div class="res-item">
                        <span class="res-label">ì†”ë£¨ì…˜ ì›” ì‹¤ì§ˆë¹„ìš© (ì„¸í›„)</span>
                        <div class="res-value" id="sol-monthly">0 ì›</div>
                        <div class="cost-breakdown">
                            <div class="cb-row"><span>â”” ì¸ê±´ë¹„ (ì¥ì• ì¸ ê¸‰ì—¬):</span> <span class="cb-val" id="sol-labor-total">0ì›</span></div>
                            <div class="cb-row"><span>â”” ì†”ë£¨ì…˜ë¹„ (ìš´ì˜/ë Œíƒˆ):</span> <span class="cb-val" id="sol-service-total">0ì›</span></div>
                            <div class="cb-row" style="color:#2563eb; border-top:1px dashed #dbeafe; margin-top:4px; padding-top:4px;">
                                <span>â”” ë²•ì¸ì„¸ ì ˆê° (20.9%):</span> <span class="cb-val" id="sol-tax-save">0ì›</span>
                            </div>
                        </div>
                    </div>
                    <div class="res-item">
                        <span class="res-label">ì”ì—¬ ë¶€ë‹´ê¸ˆ (ì›”)</span>
                        <div class="res-value" style="color:#64748b;" id="sol-remain">0 ì›</div>
                        <span class="res-sub">ëª©í‘œ ë‹¬ì„± í›„ ë‚¨ì€ íŒ¨ë„í‹°</span>
                    </div>
                    <div class="res-item">
                        <span class="res-label">5ë…„ ì´ ë¹„ìš© (TCO)</span>
                        <div class="res-value" style="color:#1e293b;" id="sol-total5y">0 ì›</div>
                        <span class="res-sub">ì„¸ê¸ˆ ì ˆê° íš¨ê³¼ ë°˜ì˜ ì™„ë£Œ</span>
                        <span style="display:block; font-size:0.8rem; color:#94a3b8; margin-top:4px;">
                            * í–¥í›„ ìµœì €ì„ê¸ˆ ì¸ìƒë¶„ ë¯¸í¬í•¨ (2026ë…„ ë¶ˆë³€ê°€ ê¸°ì¤€)
                        </span>
                    </div>
                </div>

                <div class="savings-highlight">
                    <span class="savings-title">ğŸ’° 5ë…„ ì˜ˆìƒ ì ˆê°ì•¡</span>
                    <div>
                        <span class="savings-amount" id="final-savings">0 ì›</span>
                        <span class="savings-rate-badge" id="final-rate">0%</span>
                    </div>
                </div>
            </div>

            <div class="chart-area">
                <canvas id="costChart"></canvas>
            </div>

            <div class="contact-section">
                <div style="text-align:center; margin-bottom:25px;">
                    <h2 style="margin:0 0 10px;">ìƒë‹´ ë¬¸ì˜í•˜ê¸°</h2>
                    
                    <p style="color:#64748b; margin:0; line-height:1.6; word-break: keep-all;">
                        ì •ë°€í•œ ë¶„ì„ì„ ìœ„í•´ <b>ë§¤ì›” 3ê°œì‚¬ë§Œ ì„ ì •</b>í•˜ì—¬<br>
                        ë§ì¶¤í˜• ë¹„ìš© ì ˆê° ë¦¬í¬íŠ¸ë¥¼ ì œê³µí•©ë‹ˆë‹¤. <span style="font-size:0.9rem; color:#94a3b8;">(ì¡°ê¸° ë§ˆê° ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤)</span>
                    </p>
                </div>
                
                <div class="contact-form">
                    <input type="text" id="contact-company" placeholder="íšŒì‚¬ëª… (í•„ìˆ˜)" required>
                    <input type="text" id="contact-name" placeholder="ë‹´ë‹¹ì ì„±í•¨ (í•„ìˆ˜)" required>
                    <input type="text" id="contact-email" placeholder="ì´ë©”ì¼ ì£¼ì†Œ / ì—°ë½ì²˜ (í•„ìˆ˜)" required>
                    
                    <div class="agree-box" onclick="document.getElementById('agree-check').click()">
                        <input type="checkbox" id="agree-check" onclick="event.stopPropagation()">
                        <label for="agree-check">
                            [í•„ìˆ˜] ê°œì¸ì •ë³´ ìˆ˜ì§‘ ë° ë°ì´í„° ì „ì†¡ì— ë™ì˜í•©ë‹ˆë‹¤.
                        </label>
                    </div>

                    <button class="btn-main" onclick="sendEmail()" style="background:#1e293b;">ğŸ“© ê²°ê³¼ ë¦¬í¬íŠ¸ í¬í•¨í•˜ì—¬ ë¬¸ì˜í•˜ê¸°</button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="solutionPopup" class="modal-overlay">
    <div class="modal-content">
        <div class="modal-header">
            <h2>Great Puzzle Solution</h2>
            <p>í˜ì‹  ê¸°ìˆ ê³¼ ë°ì´í„°ë¡œ ESG ê²½ì˜ì˜ ìƒˆë¡œìš´ í•´ë‹µì„ ì œì‹œí•©ë‹ˆë‹¤.</p>
        </div>
        <div class="solution-grid">
            <div class="sol-card">
                <span class="sol-icon">ğŸ¤–</span>
                <span class="sol-title">AI ë¡œë´‡ ì†”ë£¨ì…˜<br>(PETSPOT)</span>
                <ul class="sol-list">
                    <li>íˆ¬ëª… í˜íŠ¸ë³‘ ë¬´ì¸ íšŒìˆ˜ & ë¶„ì‡„</li>
                    <li><strong style="color:#2563eb">ë¶€í”¼ 1/10 ê°ì¶•</strong> (ë¬¼ë¥˜ë¹„ ì ˆê°)</li>
                    <li>ê³µì • í˜ì‹ : 15ë‹¨ê³„ â†’ 4ë‹¨ê³„</li>
                    <li>ì¸í”„ë¼ íˆ¬ì: 100ì–µ â†’ 5~10ì–µ</li>
                    <li>ì—ë„ˆì§€ ì ˆê° 80% ì´ìƒ</li>
                </ul>
            </div>
            <div class="sol-card" style="border-color:#2563eb; background:#eff6ff;">
                <span class="sol-icon">âš™ï¸</span>
                <span class="sol-title">ì¤‘ì¦ ì¥ì• ì¸ ê³ ìš©Â·ê´€ë¦¬ ì„œë¹„ìŠ¤<br>(All-in-One)</span>
                <ul class="sol-list">
                    <li><strong style="color:#2563eb">ì¤‘ì¦ ì¥ì• ì¸ ì¸ë ¥/ì„ ë°œ/ì—…ë¬´ ì§€ì›</strong></li>
                    <li>í‘œì¤€ ê·¼ë¡œê³„ì•½ ì˜¨ë¼ì¸ ì„œë¹„ìŠ¤</li>
                    <li>ê·¼íƒœê´€ë¦¬ ì•±</li>
                    <li>ìë™ ì—…ë¬´ ì§€ì‹œ & ê²°ê³¼ DB ì œê³µ</li>
                    <li>ê³ ìš©ë…¸ë™ë¶€ ì‹ ê³  ì„œë¥˜ ìë™í™”</li>
                </ul>
            </div>
            <div class="sol-card">
                <span class="sol-icon">ğŸ“Š</span>
                <span class="sol-title">ESG ë°ì´í„° & ì‚¬íšŒ ê³µí—Œ<br>(Building a Better World) </span>
                <ul class="sol-list">
                    <li><strong style="color:#2563eb">íˆ¬ëª… í˜íŠ¸ë³‘ íšŒìˆ˜ëŸ‰</strong> ì§‘ê³„</li>
                    <li>ì‹¤ì‹œê°„ íƒ„ì†Œ ì €ê°ëŸ‰ ë°ì´í„°</li>
                    <li>ì‚¬ìš©ì í¬ì¸íŠ¸ ê¸°ë¶€/ì ë¦½ í˜„í™©</li>
                    <li>ê¸°ë¶€ê¸ˆ í™œìš© ë‚´ì—­ íˆ¬ëª…ì„± ë¦¬í¬íŠ¸</li>
                    <li>ì¥ì• ì¸ ê³ ìš© ì„±ê³¼ ì§€í‘œ ê´€ë¦¬</li>
                </ul>
            </div>
        </div>
        <button class="modal-btn" onclick="closePopupAndShowResult()">ğŸš€ ì˜ˆìƒ ì ˆê°ì•¡ í™•ì¸í•˜ê¸° (Click)</button>
    </div>
</div>

<div id="overflowPopup" class="modal-overlay">
    <div class="modal-content">
        <div class="modal-header">
            <h2>ğŸ“¢ Enterprise Consultation</h2>
            <p style="color:#475569;">ê·€ì‚¬ì˜ ì••ë„ì ì¸ ê³ ìš© ê·œëª¨ì— ê²½ì˜ë¥¼ í‘œí•©ë‹ˆë‹¤.</p>
        </div>
        <div class="warning-box">
            <h3 style="margin-top:0;">ğŸ›‘ ëŒ€ê·œëª¨ ì¸í”„ë¼ ì‚¬ì „ í˜‘ì˜ í•„ìš”</h3>
            <p>
                í˜„ì¬ ì‹œë®¬ë ˆì´ì…˜ ê²°ê³¼, ê·€ì‚¬ì˜ ì˜ë¬´ ê³ ìš© í•´ê²°ì„ ìœ„í•´ <strong>750ëŒ€ ì´ìƒì˜ PETSPOT ë¡œë´‡</strong>ì´ í•„ìš”í•  ê²ƒìœ¼ë¡œ ì˜ˆìƒë©ë‹ˆë‹¤.<br>
                (1,500ëª…ë¶„ ì´ìƒì˜ ì¥ì• ì¸ ê³ ìš© íš¨ê³¼)<br><br>
                ì´ ê·œëª¨ëŠ” ë‹¨ìˆœ ë°œì£¼ê°€ ì•„ë‹Œ, <strong>ì „ìš© ìƒì‚° ë¼ì¸ í™•ë³´</strong>ì™€ <strong>ì›ìì¬ ìˆ˜ê¸‰(Raw Material)</strong>ì— ëŒ€í•œ ì •ë°€í•œ ì‚¬ì „ ê³„íšì´ í•„ìˆ˜ì ì…ë‹ˆë‹¤.
                ì¼ë°˜ ê²¬ì ìœ¼ë¡œëŠ” ì •í™•í•œ ëŒ€ì‘ì´ ì–´ë ¤ìš°ë¯€ë¡œ, VIP ì „ë‹´íŒ€ì„ í†µí•œ <strong>ë³„ë„ ì»¤ìŠ¤í…€ ì œì•ˆ(Enterprise Plan)</strong>ì„ ê¶Œì¥ë“œë¦½ë‹ˆë‹¤.
            </p>
        </div>
        <button class="modal-btn" onclick="closeOverflowPopup()" style="background:#ef4444;">í™•ì¸ (ì˜ˆìƒ ìˆ˜ì¹˜ë§Œ ë¨¼ì € ë³´ê¸°)</button>
    </div>
</div>

<script>
    // ì „ì—­ ìƒíƒœ ë³€ìˆ˜
    let state = { total: 1000, dis: 0, mode: 'purchase', targetRate: 1.0, sector: 'private' };
    let myChart = null;
    let isOverflowChecked = false; 

    // ì¸ì¦ì„œ ë°ì´í„°
    const certData = {
        'innoprod': { title: "í˜ì‹ ì œí’ˆ ì§€ì • ì¸ì¦ì„œ", content: "<strong>ì¸ì¦ë²ˆí˜¸:</strong> ì œ 2025-020í˜¸<br><strong>ì œí’ˆëª…:</strong> AI íˆ¬ëª… í˜íŠ¸ë³‘ ë¬´ì¸ ë¶„ì‡„ ë¡œë´‡<br><strong>ë°œê¸‰ê¸°ê´€:</strong> ì¡°ë‹¬ì²­ì¥" },
        'pilot': { title: "ì‹œë²”êµ¬ë§¤ ì œí’ˆ ì„ ì •", content: "<strong>ë¶„ë¥˜ë²ˆí˜¸:</strong> 2025-00595<br><strong>ì œí’ˆëª…:</strong> GP-902<br><strong>ë°œê¸‰ê¸°ê´€:</strong> ì¤‘ì†Œë²¤ì²˜ê¸°ì—…ë¶€" },
        'venture': { title: "ë²¤ì²˜ê¸°ì—… í™•ì¸ì„œ", content: "<strong>í™•ì¸ë²ˆí˜¸:</strong> ì œ 20250108030080í˜¸<br><strong>ìœ íš¨ê¸°ê°„:</strong> 2027.12.07" },
        'social': { title: "ì†Œì…œë²¤ì²˜ íŒë³„ í™•ì¸ì„œ", content: "<strong>íŒë³„ë²ˆí˜¸:</strong> ì œ 2021-01-0037 í˜¸<br><strong>ê¸°ì—…ëª…:</strong> ì£¼ì‹íšŒì‚¬ ê·¸ë ˆì´íŠ¸í¼ì¦" }
    };

    function showCert(key, btn) {
        const area = document.getElementById('cert-display-area');
        const titleEl = document.getElementById('cert-title-text');
        const contentEl = document.getElementById('cert-content-text');
        if(btn.classList.contains('active')) { btn.classList.remove('active'); area.classList.remove('show'); return; }
        document.querySelectorAll('.cert-badge').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        titleEl.innerHTML = certData[key].title;
        contentEl.innerHTML = certData[key].content;
        area.classList.add('show');
    }

    function syncVal(type, val) {
        document.getElementById(`range-${type}`).value = val;
        document.getElementById(`input-${type}`).value = val;
        state[type] = parseInt(val);
        if (type === 'total') isOverflowChecked = false;
        if(document.getElementById('resultArea').style.display === 'grid') calculate();
    }

    function setSector(type, btn) {
        state.sector = type;
        document.querySelectorAll('.sector-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        if(document.getElementById('resultArea').style.display === 'grid') calculate();
    }

    function openPopup() { document.getElementById('solutionPopup').style.display = 'flex'; }
    
    function closePopupAndShowResult() {
        document.getElementById('solutionPopup').style.display = 'none';
        document.getElementById('resultArea').style.display = 'grid'; 
        if(!myChart) initChart();
        calculate();
        document.getElementById('resultArea').scrollIntoView({ behavior: 'smooth' });
    }

    function closeOverflowPopup() {
        document.getElementById('overflowPopup').style.display = 'none';
        isOverflowChecked = true; 
        calculate(); 
    }

    function setMode(mode, btn) {
        state.mode = mode;
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        calculate();
    }

    function setTarget(rate, btn) {
        const mandatoryRate = state.sector === 'public' ? 0.038 : 0.031;
        const mandatory = Math.floor(state.total * mandatoryRate);
        const currentRatio = mandatory > 0 ? (state.dis / mandatory) : 0;

        if(currentRatio >= rate) {
            alert("ğŸ“‰ ì´ë¯¸ í•´ë‹¹ êµ¬ê°„ ì´ìƒì˜ ê³ ìš©ë¥ ì„ ë‹¬ì„±í–ˆìŠµë‹ˆë‹¤.\në” ë†’ì€ ëª©í‘œë¥¼ ì„ íƒí•˜ê±°ë‚˜, í˜„í™©ì„ ìœ ì§€í•˜ì„¸ìš”.");
            return;
        }

        state.targetRate = rate;
        document.querySelectorAll('.target-btn').forEach(b => b.classList.remove('selected'));
        btn.classList.add('selected');
        calculate();
    }

    function sendEmail() {
        const company = document.getElementById('contact-company').value;
        const name = document.getElementById('contact-name').value;
        const email = document.getElementById('contact-email').value;
        const isAgreed = document.getElementById('agree-check').checked;

        if(!company || !name || !email) { alert("íšŒì‚¬ëª…, ë‹´ë‹¹ìëª…, ì—°ë½ì²˜ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."); return; }
        if(!isAgreed) { alert("ê°œì¸ì •ë³´ ìˆ˜ì§‘ ë™ì˜ê°€ í•„ìš”í•©ë‹ˆë‹¤."); return; }

        const btn = event.target;
        btn.innerText = "ì „ì†¡ ì¤‘ì…ë‹ˆë‹¤...";
        btn.disabled = true;

        const params = {
            company_name: company,
            user_name: name,
            user_contact: email,
            email: email,
            message: `[ì‹œë®¬ë ˆì´ì…˜ ê²°ê³¼]\n- ê¸°ì—…ê·œëª¨: ${state.total}ëª…\n- ì˜ˆìƒì ˆê°ì•¡: ${document.getElementById('final-savings').innerText}`
        };

        emailjs.send('service_cmnxjma', 'template_rmp1gew', params)
            .then(() => { alert('ë¬¸ì˜ê°€ ì ‘ìˆ˜ë˜ì—ˆìŠµë‹ˆë‹¤.'); btn.innerText = "ì „ì†¡ ì™„ë£Œ"; })
            .catch((err) => { alert('ì „ì†¡ ì‹¤íŒ¨: ' + JSON.stringify(err)); btn.innerText = "ë‹¤ì‹œ ë³´ë‚´ê¸°"; btn.disabled = false; });
    }

    function calculate() {
        const mandatoryRate = state.sector === 'public' ? 0.038 : 0.031;
        const mandatory = Math.floor(state.total * mandatoryRate);
        const currentRecognized = state.dis;
        const unfilled = Math.max(0, mandatory - currentRecognized);
        const ratio = mandatory > 0 ? currentRecognized / mandatory : 0;
        
        const currentRate = state.total > 0 ? (state.dis / state.total) * 100 : 0;
        document.getElementById('val-current-rate').innerText = currentRate.toFixed(2);

        const btnTargets = [0.25, 0.50, 0.75, 1.0];
        btnTargets.forEach(target => {
            const btnId = `btn-${target*100}`;
            const btnEl = document.getElementById(btnId);
            if(ratio >= target) btnEl.classList.add('disabled');
            else btnEl.classList.remove('disabled');
        });

        let unitCost = 0;
        for(let i=0; i<BURDEN_TIERS.length; i++) {
            if(ratio < BURDEN_TIERS[i].limit || i === BURDEN_TIERS.length-1) {
                unitCost = (currentRecognized === 0 && mandatory > 0) ? BURDEN_TIERS[0].cost : BURDEN_TIERS[i].cost;
                break;
            }
        }

        const currentMonthlyLevy = unfilled * unitCost;
        const current5y = currentMonthlyLevy * 60;

        document.getElementById('val-mandatory').innerText = mandatory;
        document.getElementById('val-current').innerText = currentRecognized;
        document.getElementById('val-unfilled').innerText = unfilled;
        document.getElementById('val-unit').innerText = (unitCost/10000).toLocaleString();
        document.getElementById('val-5yLevy').innerText = formatMoney(current5y);

        const targetRecognizedTotal = Math.ceil(mandatory * state.targetRate);
        let gapRecognized = Math.max(0, targetRecognizedTotal - currentRecognized);
        const hires = Math.ceil(gapRecognized / 2);
        
        if (gapRecognized >= 2000 && !isOverflowChecked) {
            document.getElementById('overflowPopup').style.display = 'flex';
        }

        const gainedRecognized = hires * 2;
        // ë¬¸êµ¬ ìˆ˜ì •: 1ëŒ€ë‹¹ 2ë°°ìˆ˜ ì¸ì • ê°•ì¡°
        document.getElementById('sol-logic-text').innerText = `ë¯¸ë‹¬ ${gapRecognized}ëª… Ã· 2 (ì¤‘ì¦ë”ë¸”) = ${hires}ëª… (ë¡œë´‡ ${hires}ëŒ€)`;

        let discount = 0;
        let activeRowId = "row-t1";
        if(hires >= 31) { discount = 0.25; activeRowId = "row-t4"; }
        else if(hires >= 21) { discount = 0.20; activeRowId = "row-t3"; }
        else if(hires >= 11) { discount = 0.15; activeRowId = "row-t2"; }
        else { discount = 0; activeRowId = "row-t1"; }

        let enterpriseDiscount = 0;
        if(state.total >= 10000) enterpriseDiscount = 0.15; 
        else if(state.total >= 5000) enterpriseDiscount = 0.10; 
        else if(state.total >= 1000) enterpriseDiscount = 0.05; 

        const finalDiscountRate = discount + enterpriseDiscount;

        // [ë¹„ìš© ê³„ì‚° í•¨ìˆ˜: 1ë‹¨ìœ„ (ë¡œë´‡ 1ëŒ€ = 2ì¸ íš¨ê³¼) ê¸°ì¤€]
        function getUnitCost(mode) {
            let monthlyPreTax = 0;
            // * ë Œíƒˆí˜•ì„ ê°€ì¥ ë¹„ì‹¸ê²Œ ì„¤ì • (Hierarchy ìœ ì§€)
            if(mode === 'purchase') {
                const dev = BASE_CONFIG.purchaseListPrice * (1 - finalDiscountRate);
                monthlyPreTax = (dev / 60) + BASE_CONFIG.purchaseOp + BASE_CONFIG.labor;
            } else if(mode === 'hybrid') {
                const rent = BASE_CONFIG.hybridRent * (1 - finalDiscountRate);
                // ë³´ì¦ê¸ˆ/60 + ë Œíƒˆë£Œ + ìš´ì˜ë¹„(purchaseOp) + ì¸ê±´ë¹„
                const depositPart = BASE_CONFIG.hybridDeposit / 60; 
                monthlyPreTax = rent + BASE_CONFIG.purchaseOp + BASE_CONFIG.labor + depositPart;
            } else { // rental
                // ë Œíƒˆë£Œ(í• ì¸) + ì¸ê±´ë¹„
                const rentTotal = BASE_CONFIG.rentalMonthly * (1 - finalDiscountRate);
                monthlyPreTax = rentTotal + BASE_CONFIG.labor;
            }

            // ì„¸ê¸ˆ ì ˆê° (ì „ì•¡ ì†ê¸ˆì‚°ì…)
            const taxSave = monthlyPreTax * BASE_CONFIG.taxRate;
            
            // ëŒ€ë‹¹ ì›” ì‹¤ì§ˆ ë¹„ìš© ë° ë‚´ì—­ ë°˜í™˜
            return {
                preTax: monthlyPreTax,
                taxSave: taxSave,
                real: monthlyPreTax - taxSave,
                solPart: monthlyPreTax - BASE_CONFIG.labor // ìˆœìˆ˜ ì†”ë£¨ì…˜ ë¹„ìš© ë¶€ë¶„ (ì¸ê±´ë¹„ ì œì™¸)
            };
        }

        // í˜„ì¬ ì„ íƒëœ ëª¨ë“œì˜ ë¹„ìš© ê³„ì‚°
        const currentUnit = getUnitCost(state.mode);
        const solMonthlyRealTotal = currentUnit.real * hires; // ì´ ì›” ë¹„ìš©

        // ì”ì—¬ ë¶€ë‹´ê¸ˆ ê³„ì‚°
        const remainUnfilled = Math.max(0, unfilled - gainedRecognized);
        let remainCost = 0;
        if(remainUnfilled > 0) {
            const newTotalRec = currentRecognized + gainedRecognized;
            const newRatio = mandatory > 0 ? newTotalRec/mandatory : 0;
            let newUnit = 0;
            for(let i=0; i<BURDEN_TIERS.length; i++) {
                if(newRatio < BURDEN_TIERS[i].limit || i === BURDEN_TIERS.length-1) {
                    newUnit = (newTotalRec === 0 && mandatory > 0) ? BURDEN_TIERS[0].cost : BURDEN_TIERS[i].cost;
                    break;
                }
            }
            remainCost = remainUnfilled * newUnit;
        }
        const remainCostMonthly = remainCost; 

        // 5ë…„ ì´ ë¹„ìš© (TCO)
        const total5yReal = (solMonthlyRealTotal * 60) + (remainCostMonthly * 60);

        document.querySelectorAll('.discount-table tr').forEach(tr => tr.classList.remove('active-tier'));
        document.getElementById(activeRowId).classList.add('active-tier');

        // ê²°ê³¼ í‘œì‹œ ì—…ë°ì´íŠ¸
        document.getElementById('sol-hires').innerText = hires + " ëŒ€";
        
        let monthlyText = parseInt(solMonthlyRealTotal).toLocaleString() + " ì›";
        if(enterpriseDiscount > 0) {
            monthlyText += "<br><span style='font-size:0.8rem; color:#ef4444'>ğŸ“‰ ì—”í„°í”„ë¼ì´ì¦ˆ í• ì¸ & ì ˆì„¸ ì ìš©</span>";
        }
        document.getElementById('sol-monthly').innerHTML = monthlyText;
        
        // ìƒì„¸ ë‚´ì—­ ì—…ë°ì´íŠ¸ (ì˜¤ë¥¸ìª½ íŒ¨ë„)
        document.getElementById('sol-labor-total').innerText = parseInt(BASE_CONFIG.labor * hires).toLocaleString() + " ì›";
        document.getElementById('sol-service-total').innerText = parseInt(currentUnit.solPart * hires).toLocaleString() + " ì›";
        document.getElementById('sol-tax-save').innerText = "-" + parseInt(currentUnit.taxSave * hires).toLocaleString() + " ì›";

        document.getElementById('sol-remain').innerText = parseInt(remainCostMonthly).toLocaleString() + " ì›";
        document.getElementById('sol-total5y').innerText = formatMoney(total5yReal);

        const saveAmt = current5y - total5yReal;
        const savePct = current5y > 0 ? ((saveAmt / current5y) * 100).toFixed(1) : 0;
        
        const saveEl = document.getElementById('final-savings');
        const rateEl = document.getElementById('final-rate');
        
        if(saveAmt > 0) {
            saveEl.innerText = formatMoney(saveAmt);
            saveEl.style.color = "#4ade80";
            rateEl.innerText = savePct + "% ì ˆê°";
            rateEl.style.background = "#4ade80"; rateEl.style.color = "#064e3b";
        } else {
            saveEl.innerText = "0ì›";
            rateEl.innerText = "ë™ì¼";
        }

        // ============================
        // âœ… 2ì¸ ê¸°ì¤€ ì¢Œì¸¡ íŒ¨ë„ ë™ì  ì—…ë°ì´íŠ¸ (ì™„ë²½ í•´ê²°)
        // ============================
        
        // 1. ë¯¸ê³ ìš© ë¶€ë‹´ê¸ˆ (2ì¸)
        const burden2p = unitCost * 2; 
        document.getElementById('comp-burden-2p').innerText = (burden2p/10000).toFixed(1) + "ë§Œì›";
        
        // 2. ì†”ë£¨ì…˜ ë„ì… (1ëŒ€ = 2ì¸ íš¨ê³¼) - ì„ íƒëœ ëª¨ë“œ ê¸°ì¤€ ë™ì  ë°˜ì˜
        let modeLabel = "êµ¬ë§¤í˜•";
        if(state.mode === 'rental') modeLabel = "ë Œíƒˆí˜•";
        else if(state.mode === 'hybrid') modeLabel = "í•˜ì´ë¸Œë¦¬ë“œ";
        
        document.getElementById('comp-model-label').innerText = `ğŸ”µ ê·¸ë ˆì´íŠ¸í¼ì¦ (${modeLabel})`;

        // 1ë‹¨ìœ„(2ì¸ë¶„) ë¹„ìš© í‘œì‹œ
        document.getElementById('comp-purchase-2p').innerText = (currentUnit.real/10000).toFixed(1) + "ë§Œì›";
        document.getElementById('comp-sol-detail').innerText = (currentUnit.solPart/10000).toFixed(1) + "ë§Œì›";
        document.getElementById('comp-tax-detail').innerText = "-" + (currentUnit.taxSave/10000).toFixed(1) + "ë§Œì›";
        
        const save2p = burden2p - currentUnit.real;
        const saveRate2p = (save2p / burden2p) * 100;
        document.getElementById('comp-save-2p').innerText = `âš¡ ì›” ${(save2p/10000).toFixed(0)}ë§Œì› ì ˆê° (${saveRate2p.toFixed(0)}%)`;


        // ì°¨íŠ¸ ì—…ë°ì´íŠ¸ (Hierarchy ê°•ì œ)
        if(myChart) {
            let colors = ['#ef4444', '#cbd5e1', '#cbd5e1', '#cbd5e1'];
            // í˜„ì¬ ëª¨ë“œ ê°•ì¡° (íŒŒë€ìƒ‰)
            if(state.mode === 'rental') colors[1] = '#2563eb';
            else if(state.mode === 'hybrid') colors[2] = '#2563eb';
            else colors[3] = '#2563eb';

            const remain5y = remainCostMonthly * 60;
            
            // ì°¨íŠ¸ìš© 5ë…„ ì´ë¹„ìš© ê³„ì‚° (ëª¨ë“  ëª¨ë“œ)
            function get5yTotal(mode) {
                // í˜„ì¬ í• ì¸ìœ¨ ì ìš©ëœ 1ëŒ€ë‹¹ ë¹„ìš© * ëŒ€ìˆ˜ * 60ê°œì›”
                const u = getUnitCost(mode);
                return (u.real * hires * 60) + remain5y;
            }

            myChart.data.datasets[0].backgroundColor = colors;
            myChart.data.datasets[0].data = [
                current5y, 
                get5yTotal('rental'), 
                get5yTotal('hybrid'), 
                get5yTotal('purchase')
            ];
            myChart.update();
        }
    }

    function formatMoney(n) {
        if(n >= 100000000) return (n/100000000).toFixed(1) + "ì–µì›";
        return Math.round(n).toLocaleString() + "ì›";
    }

    function initChart() {
        const ctx = document.getElementById('costChart').getContext('2d');
        myChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['í˜„ì¬ ë¶€ë‹´ê¸ˆ', 'ë Œíƒˆí˜•(5ë…„)', 'í•˜ì´ë¸Œë¦¬ë“œ(5ë…„)', 'êµ¬ë§¤í˜•(Best)'],
                datasets: [{
                    label: '5ë…„ ì´ ì‹¤ì§ˆë¹„ìš© (ì„¸í›„)',
                    data: [0, 0, 0, 0],
                    backgroundColor: ['#ef4444', '#cbd5e1', '#cbd5e1', '#2563eb'],
                    borderRadius: 8,
                    barThickness: 40
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: false } },
                scales: { y: { beginAtZero: true, ticks: { callback: v => (v/100000000).toFixed(0) + 'ì–µ' } }, x: { grid: { display: false } } }
            }
        });
    }
</script>

</body>
</html>

